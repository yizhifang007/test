var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);n.prototype=e.prototype,t.prototype=new n},__awaiter=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,a){function r(t){try{c(o.next(t))}catch(e){a(e)}}function s(t){try{c(o["throw"](t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(r,s)}c((o=o.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function n(t){return function(e){return o([t,e])}}function o(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(r=a[2&n[0]?"return":n[0]?"throw":"next"])&&!(r=r.call(a,n[1])).done)return r;switch(a=0,r&&(n=[0,r.value]),n[0]){case 0:case 1:r=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(r=c.trys,!(r=r.length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){c.label=n[1];break}if(6===n[0]&&c.label<r[1]){c.label=r[1],r=n;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(n);break}r[2]&&c.ops.pop(),c.trys.pop();continue}n=e.call(t,c)}catch(o){n=[6,o],a=0}finally{i=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,r,s,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},BaseClass=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this;return n._instance||(n._instance=new n(t)),n._instance},e}(eui.Component);__reflect(BaseClass.prototype,"BaseClass");var BaseSound=function(){function t(){this._cache={},this._loadingCache=new Array;var t=new egret.Timer(6e4,0);t.addEventListener(egret.TimerEvent.TIMER,this.dealSoundTimer,this)}return t.prototype.dealSoundTimer=function(){console.log("清理声音文件");for(var t=egret.getTimer(),e=Object.keys(this._cache),n=0,o=e.length;o>n;n++){var i=e[n];this.checkCanClear(i)&&t-this._cache[i]>=SoundManager.CLEAR_TIME&&(delete this._cache[i],RES.destroyRes(i))}},t.prototype.getSound=function(t){var e=RES.getRes(t);if(e)this._cache[t]&&(this._cache[t]=egret.getTimer());else{if(-1!=this._loadingCache.indexOf(t))return null;this._loadingCache.push(t),RES.getResAsync(t,this.onResourceLoadComplete,this)}return e},t.prototype.onResourceLoadComplete=function(t,e){var n=this._loadingCache.indexOf(e);-1!=n&&(this._loadingCache.splice(n,1),this._cache[e]=egret.getTimer(),this.loadedPlay(e))},t.prototype.loadedPlay=function(t){},t.prototype.checkCanClear=function(t){return!0},t}();__reflect(BaseSound.prototype,"BaseSound");var userHeadComponent=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e}(eui.Component);__reflect(userHeadComponent.prototype,"userHeadComponent",["eui.UIComponent","egret.DisplayObject"]);var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var StageUtils=function(t){function e(){var n=t.call(this)||this;return n.stageMaxWidth=0,n.stageMaxHeight=0,null==e._uiStage&&(e._uiStage=new eui.UILayer,e._uiStage.percentHeight=100,e._uiStage.percentWidth=100,e._uiStage.touchEnabled=!1,n.getStage().addChild(e._uiStage)),n}return __extends(e,t),e.prototype.getHeight=function(){return this.getStage().stageHeight},e.prototype.getMaxHeight=function(){return this.stageMaxHeight},e.prototype.setMaxHeight=function(t){this.stageMaxHeight=t},e.prototype.getWidth=function(){return this.getStage().stageWidth},e.prototype.getMaxWidth=function(){return this.stageMaxWidth},e.prototype.setMaxWidth=function(t){this.stageMaxWidth=t},e.prototype.setTouchChildren=function(t){this.getStage().touchChildren=t},e.prototype.setMaxTouches=function(t){this.getStage().maxTouches=t},e.prototype.setFrameRate=function(t){this.getStage().frameRate=t},e.prototype.setScaleMode=function(t){this.getStage().scaleMode=t},e.prototype.getStage=function(){return egret.MainContext.instance.stage},e.prototype.getUIStage=function(){return e._uiStage},e.prototype.startFullscreenAdaptation=function(t,e,n){this.designWidth=t,this.designHeight=e,this.resizeCallback=n,console.log("当前屏幕宽高",this.designWidth,this.designHeight),this.stageOnResize()},e.prototype.stageOnResize=function(){this.getStage().removeEventListener(egret.Event.RESIZE,this.stageOnResize,this);var t=this.designWidth,e=this.designHeight;this.getStage().setContentSize(t,e),this.stageMaxWidth<this.getWidth()&&(this.stageMaxWidth=this.getWidth(),this.setMaxWidth(this.getWidth())),this.stageMaxHeight<this.getHeight()&&(this.stageMaxHeight=this.getHeight(),this.setMaxHeight(this.getHeight())),this.resizeCallback&&this.resizeCallback(),this.getStage().addEventListener(egret.Event.RESIZE,this.stageOnResize,this)},e}(BaseClass);__reflect(StageUtils.prototype,"StageUtils");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,o){function i(t){e.call(o,t)}function a(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),n.call(o))}var r=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(o,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,n){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(o,generateEUI2)},r)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var s=t.split("/");s.pop();var c=s.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(o,generateJSON.paths[t])},this):RES.getResByUrl(c,function(n){window.JSONParseClass.setData(n),egret.callLater(function(){e.call(o,generateJSON.paths[t])},r)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(o,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var ctrl=function(t){function e(){var e=t.call(this)||this;return e.initModel(),EventManager.addEventListener(egretEvent.ADD_MODEL,e.addModel,e),EventManager.addEventListener(egretEvent.REMOVE_MODEL,e.removeModel,e),e}return __extends(e,t),e.prototype.initModel=function(){this.loginCmp=new eui.UILayer,this.loginCmp.touchThrough=!0,this.loginCmp.name="login",this.addChild(this.loginCmp),this.lobbyCmp=new eui.UILayer,this.lobbyCmp.touchThrough=!0,this.lobbyCmp.name="lobby",this.addChild(this.lobbyCmp),this.gameCmp=new eui.UILayer,this.gameCmp.touchThrough=!0,this.gameCmp.name="game",this.addChild(this.gameCmp),this.loadingCmp=new eui.UILayer,this.loadingCmp.touchThrough=!0,this.loadingCmp.name="loading",this.addChild(this.loadingCmp),this.dialogCmp=new eui.UILayer,this.dialogCmp.touchThrough=!0,this.dialogCmp.name="dialog",this.addChild(this.dialogCmp)},e.prototype.addModel=function(t){console.log(">>>>>>>>>>>>>添加模块",t.data);var e=t.data;switch(e){case"login":var n=loginComponent.getInstance();this.loginCmp.addChild(n);break;case"lobby":var o=lobbyComponent.getInstance();this.lobbyCmp.addChild(o);break;case"game":var i=gameComponent.getInstance();this.gameCmp.addChild(i);break;case"dialog":var a=new loginComponent;this.dialogCmp.addChild(a)}},e.prototype.removeModel=function(t){console.log(">>>>>>>>>>>>>移除模块",t.data);var e=t.data;switch(e){case"login":this.loginCmp.removeChildren();break;case"lobby":this.lobbyCmp.removeChildren();break;case"game":this.gameCmp.removeChildren();break;case"dialog":this.dialogCmp.removeChildren()}},e}(eui.UILayer);__reflect(ctrl.prototype,"ctrl");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function o(o){e.call(n,o,t)}if(RES.hasRes(t)){var i=RES.getRes(t);i?o(i):RES.getResAsync(t,o,this)}else RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var gameInfo=function(){function t(){}return t.gameState=0,t.httpIp="http://192.168.30.106/",t.websocketIp="120.26.82.88",t.websocketHost=9502,t.websocketToken="",t.roomList={},t}();__reflect(gameInfo.prototype,"gameInfo");var userInfo=function(){function t(){}return t.nickName="",t.userId=0,t.token="",t.timestamp="",t.headImg="",t.gold=0,t.diamond=0,t.createTime="",t.gameId="",t.ip="",t.isDisabled="",t.loseNum="",t.point="",t.sex="",t.winNum="",t}();__reflect(userInfo.prototype,"userInfo");var dialogComponent=function(t){function e(){var e=t.call(this)||this;return e.data=null,e}return __extends(e,t),e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e}(eui.Component);__reflect(dialogComponent.prototype,"dialogComponent",["eui.UIComponent","egret.DisplayObject"]);var egretEvent=function(t){function e(e,n){void 0===n&&(n=null);var o=t.call(this,e,n)||this;return o.type="",o.data=null,o.data=n,o}return __extends(e,t),e.ADD_MODEL="ADD_MODEL",e.REMOVE_MODEL="REMOVE_MODEL",e}(egret.Event);__reflect(egretEvent.prototype,"egretEvent");var EventManager=function(t){function e(e){void 0===e&&(e=null);var n=t.call(this,e)||this;return n.CTRLADD="CTRLADD",n.event=new egret.Event("",!1,!1,null),n}return __extends(e,t),e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.dispatchEvent=function(t){this.getInstance().dispatchEvent(t)},e.addEventListener=function(t,e,n){this.getInstance().addEventListener(t,e,n)},e.hasEventListener=function(t){return this.getInstance().hasEventListener(t)},e.removeEventListener=function(t,e){this.getInstance().removeEventListener(t,e,this)},e}(egret.EventDispatcher);__reflect(EventManager.prototype,"EventManager");var gameComponent=function(t){function e(){var e=t.call(this)||this;return e.location=-1,e.lastLocation=-1,e.lastValue=-1,e.handCardArr_1=[],e.handCardArr_2=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],e.handCardArr_3=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],e.handCardArr_4=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],e.disCardPool_1=[],e.disCardPool_2=[],e.disCardPool_3=[],e.disCardPool_4=[],e.drawnCardNum_1=-1,e.drawnCardNum_2=-1,e.drawnCardNum_3=-1,e.drawnCardNum_4=-1,e.pong=0,e.chow=[],e.kong=0,e.win=0,e.cWin=null,e.kongType="",e}return __extends(e,t),e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initEvent()},e.prototype.initEvent=function(){this.chiBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.chiFun,this),this.pengBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.pengFun,this),this.gangBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gangFun,this),this.guoBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.guoFun,this),this.huBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.huFun,this)},e.prototype.chiFun=function(){if(this.chow.length>1){this.chooseChow.visible=!0;for(var t=0;t<this.chow.length;t++){var e=new CPGComponent(this.lastValue,this.chow[t][0],this.chow[t][1],0,1);e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendChoose.bind(this,this.chow[t]),this),this.chooseChow.addChild(e)}}else this.chiBtn.visible=!1,this.chiBtn.width=0,this.sendChoose([this.chow[0][0],this.chow[0][1]])},e.prototype.pengFun=function(){socketManger.getInstance().send('{"cmd":"needChowPongKongWin","data":{"type":"pong","value":'+this.pong+"}}")},e.prototype.gangFun=function(){""==this.kongType?socketManger.getInstance().send('{"cmd":"needChowPongKongWin","data":{"type":"kong","value":'+this.kong+"}}"):"cKong"==this.kongType?socketManger.getInstance().send('{"cmd":"needKongWin","data":{"type":"cKong","value":'+this.kong+"}}"):"pKong"==this.kongType&&socketManger.getInstance().send('{"cmd":"needKongWin","data":{"type":"pKong","value":'+this.kong+"}}")},e.prototype.guoFun=function(){this.chooseChow.removeChildren(),socketManger.getInstance().send('{"cmd":"passChowPongKongWin","data":{}}'),this.resetBtn()},e.prototype.huFun=function(){this.cWin?socketManger.getInstance().send('{"cmd":"needKongWin","data":{"type":"cWin","value":'+this.win+"}}"):socketManger.getInstance().send('{"cmd":"needChowPongKongWin","data":{"type":"win","value":'+this.win+"}}")},e.prototype.touziMc=function(){},e.prototype.resetBtn=function(){this.chiBtn.visible=!1,this.chiBtn.width=0,this.pengBtn.visible=!1,this.pengBtn.width=0,this.gangBtn.visible=!1,this.gangBtn.width=0,this.guoBtn.visible=!1,this.guoBtn.width=0,this.huBtn.visible=!1,this.huBtn.width=0},e.prototype.playingCard=function(t,e){console.log("摸牌222333",t,e),this["drawnCard_"+t].addChild(new cardComponent(t,e,-1))},e.prototype.clearDrawnCard=function(t){this["drawnCard_"+t].removeChildren()},e.prototype.dealCards=function(){for(var t=1;5>t;t++)for(var e=0;e<this["handCardArr_"+t].length;e++)this["handCardGrp_"+t].addChild(new cardComponent(t,this["handCardArr_"+t][e],e))},e.prototype.sortNumber=function(t,e){return t-e},e.prototype.upDateCard=function(t){this.handCardArr_1.sort(this.sortNumber),this["handCardGrp_"+t].removeChildren(),this["discard_"+t].removeChildren();for(var e=0;e<this["handCardArr_"+t].length;e++)this["handCardGrp_"+t].addChild(new cardComponent(t,this["handCardArr_"+t][e],e));for(var e=0;e<this["disCardPool_"+t].length;e++)this["discard_"+t].addChild(new cardComponent(t+4,this["disCardPool_"+t][e],e))},e.prototype.startGame=function(t){this.fengGroup.visible=!0,this.waitTxt.visible=!1,this.setOtherUserInfo(t)},e.prototype.setOtherUserInfo=function(t){},e.prototype.setHandData=function(t){this.handCardArr_1=t.sort(this.sortNumber),console.log("手牌数据》》》》",this.handCardArr_1),this.dealCards()},e.prototype.setdiceNum=function(t){},e.prototype.showCPGBtn=function(t){this.resetBtn(),t.pong&&(console.log("可碰",t.pong),this.pong=t.pong,this.pengBtn.visible=!0,this.pengBtn.width=120),t.kong&&(console.log("可杠",t.kong),this.kong=t.kong,this.gangBtn.visible=!0,this.gangBtn.width=120),t.chow&&(console.log("可吃",t.chow),this.chow=t.chow,this.chiBtn.visible=!0,this.chiBtn.width=120),t.win&&(console.log("可胡",t.win),this.win=t.win,this.huBtn.visible=!0,this.huBtn.width=120),this.guoBtn.width=120,this.guoBtn.visible=!0},e.prototype.cWinFun=function(t){console.log("自摸胡",t.value,t.type),this.resetBtn(),this.win=t.value,this.cWin=t.type,this.huBtn.visible=!0,this.huBtn.width=120,this.guoBtn.visible=!0,this.guoBtn.width=120},e.prototype.cpKongFun=function(t){this.resetBtn(),this.kongType=t.type,this.gangBtn.visible=!0,this.gangBtn.width=120,this.guoBtn.visible=!0,this.guoBtn.width=120},e.prototype.sendChoose=function(t){this.chooseChow.removeChildren(),socketManger.getInstance().send('{"cmd":"needChowPongKongWin","data":{"type":"chow","value":['+t+"]}}")},e.prototype.showCPG=function(t){switch(this.resetBtn(),this.showFeng(this.chairToView(t.location)),t.type){case"pong":var e=[t.value[0],t.value[1]];if(this.location==t.location){for(var n=0;n<this.handCardArr_1.length;n++)for(var o=0;o<e.length;o++)this.handCardArr_1[n]==e[o]&&this.handCardArr_1.splice(n,1);this["disCardPool_"+this.lastLocation].pop(),this.upDateCard(1);var i=new CPGComponent(t.value[0],t.value[1],t.value[2],0,1);i.name="pong_"+t.value[0],this.CPG1.addChild(i)}else{this["handCardArr_"+this.chairToView(t.location)].splice(0,2),this["disCardPool_"+this.lastLocation].pop(),this.upDateCard(this.chairToView(t.location)),console.log("手牌长度",this.chairToView(t.location),this["handCardArr_"+this.chairToView(t.location)].length);var i=new CPGComponent(t.value[0],t.value[1],t.value[2],0,this.chairToView(t.location));i.name="pong_"+t.value[0],this["CPG"+this.chairToView(t.location)].addChild(i)}break;case"kong":var a=[t.value[0],t.value[1],t.value[2]];if(this.location==t.location){for(var n=0;n<this.handCardArr_1.length;n++)for(var o=0;o<a.length;o++)this.handCardArr_1[n]==a[o]&&this.handCardArr_1.splice(n,1);this["disCardPool_"+this.lastLocation].pop(),this.upDateCard(1),this.CPG1.addChild(new CPGComponent(t.value[0],t.value[1],t.value[2],t.value[3],1))}else this["handCardArr_"+this.chairToView(t.location)].splice(0,3),this["disCardPool_"+this.lastLocation].pop(),console.log("手牌长度",this.chairToView(t.location),this["handCardArr_"+this.chairToView(t.location)].length),this.upDateCard(this.chairToView(t.location)),this["CPG"+this.chairToView(t.location)].addChild(new CPGComponent(t.value[0],t.value[1],t.value[2],t.value[3],this.chairToView(t.location)));break;case"cKong":this.location==t.location?this.CPG1.addChild(new CPGComponent(t.value,t.value,t.value,t.value,5)):this["CPG"+this.chairToView(t.location)].addChild(new CPGComponent(t.value,t.value,t.value,t.value,this.chairToView(t.location)+4));break;case"pKong":if(this.location==t.location)for(var n=0;n<this.CPG1.$children.length;n++)this.CPG1.$children[n].name=="pong_"+t.value&&(this.CPG1.$children[n]=new CPGComponent(t.value,t.value,t.value,t.value,1));else for(var n=0;n<this["CPG"+this.chairToView(t.location)].length;n++)this["CPG"+this.chairToView(t.location)].$children[n].name=="pong_"+t.value&&(this["CPG"+this.chairToView(t.location)].$children[n]=new CPGComponent(t.value,t.value,t.value,t.value,this.chairToView(t.location)));break;case"chow":if(this.location==t.location){this.CPG1.addChild(new CPGComponent(t.value[0],t.value[1],t.value[2],0,1));var r=t.value;console.log("chow",t.value);for(var n=0;n<this.handCardArr_1.length;n++)for(var o=0;o<r.length;o++)console.log(r[o]),this.handCardArr_1[n]==r[o]&&this.lastLocation!=r[o]&&this.handCardArr_1.splice(n,1);this["disCardPool_"+this.lastLocation].pop(),this.upDateCard(1)}else this["handCardArr_"+this.chairToView(t.location)].splice(0,2),this["CPG"+this.chairToView(t.location)].addChild(new CPGComponent(t.value[0],t.value[1],t.value[2],0,this.chairToView(t.location))),this["disCardPool_"+this.lastLocation].pop(),console.log("手牌长度",this.chairToView(t.location),this["handCardArr_"+this.chairToView(t.location)].length),this.upDateCard(this.chairToView(t.location));break;case"win":}},e.prototype.showSettlement=function(t){this.addChild(new settlementComponent(t))},e.prototype.getCard=function(t,e){var n=this.chairToView(e);this.showFeng(n),this.playingCard(n,t),this.location==e?(this.handCardArr_1.push(t),this.handCardArr_1.sort(this.sortNumber)):this["handCardArr_"+n].push(-1),console.log("摸牌>>>",t,this["handCardArr_"+this.chairToView(e)].length)},e.prototype.setCard=function(t,n){if(this.lastValue=t,n==this.location)for(var o=0;o<this.handCardArr_1.length;o++)this.handCardArr_1[o]==t&&this.handCardArr_1.splice(o,1);else this["handCardArr_"+this.chairToView(n)].splice(0,1);var i=this.chairToView(n);console.log("出牌>>>",t,this["handCardArr_"+this.chairToView(n)].length),this["disCardPool_"+i].push(t),this.lastLocation=i,this.upDateCard(i),e.getInstance().clearDrawnCard(i)},e.prototype.chairToView=function(t){var e=0;return e=t-this.location,e=(e+=4)%4+1},e.prototype.showFeng=function(t){for(var e=1;5>e;e++)this["d_"+e].visible=!1;this["d_"+t].visible=!0},e.prototype.reset=function(){this.waitTxt.visible=!0;for(var t=1;5>t;t++)this["CPG"+t].removeChildren(),this["handCard_"+t].removeChildren(),this["handCardArr_"+t]=[],this["discard_"+t].removeChildren(),this["d_"+t].visible=!1},e}(eui.Component);__reflect(gameComponent.prototype,"gameComponent",["eui.UIComponent","egret.DisplayObject"]);var cardComponent=function(t){function e(e,n,o){void 0===n&&(n=-1),void 0===o&&(o=-1);var i=t.call(this)||this;return i.chairIndex=-1,i.value=-1,i.cardIndex=-1,i.chairIndex=e,console.log("设置牌",e,n,o),-1!=n&&(i.value=n,i.cardIndex=o),i}return __extends(e,t),e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init(),this.initEvent()},e.prototype.initEvent=function(){1==this.chairIndex&&this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.playCard,this)},e.prototype.playCard=function(){socketManger.getInstance().send('{"cmd":"discard","data":{"value":'+this.value+"}}")},e.prototype.getSource=function(t){switch(t){case 0:return"wan";case 1:return"tong";case 2:return"suo";case 3:return"xz"}},e.prototype.init=function(){switch(this.chairIndex){case 1:this.chair1.visible=!0,this.word1.source="cardImg_json."+this.getSource(Math.floor(this.value/10))+"_z_"+this.value%10;break;case 2:this.chair2.visible=!0;break;case 3:this.chair3.visible=!0;break;case 4:this.chair4.visible=!0;break;case 5:this.chair5.visible=!0,this.word5.source="cardImg_json."+this.getSource(Math.floor(this.value/10))+"_z_"+this.value%10;break;case 6:this.chair6.visible=!0,this.word6.source="cardImg_json."+this.getSource(Math.floor(this.value/10))+"_z_"+this.value%10;break;case 7:this.chair7.visible=!0,this.word7.source="cardImg_json."+this.getSource(Math.floor(this.value/10))+"_z_"+this.value%10;break;case 8:this.chair8.visible=!0,this.word8.source="cardImg_json."+this.getSource(Math.floor(this.value/10))+"_z_"+this.value%10}},e}(eui.Component);__reflect(cardComponent.prototype,"cardComponent",["eui.UIComponent","egret.DisplayObject"]);var CPGComponent=function(t){function e(e,n,o,i,a){void 0===i&&(i=0);var r=t.call(this)||this;return r.chairIndex=0,r.value1=e,r.value2=n,r.value3=o,r.value4=i,r.chairIndex=a,console.log(),r}return __extends(e,t),e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this["CPGGroup"+this.chairIndex].visible=!0;for(var e=1;5>e;e++)4>e?(console.log("显示",this.chairIndex+"_"+e,this["card"+this.chairIndex+"_"+e],this["value"+e],this.chairIndex),this["card"+e+"_"+this.chairIndex].removeChildren(),this["card"+e+"_"+this.chairIndex].name="card"+this.chairIndex+"_"+e,this["card"+e+"_"+this.chairIndex].addChild(new cardComponent(this.chairIndex+4,this["value"+e],0))):0!=this.value4&&(this["card"+e+"_"+this.chairIndex].removeChildren(),this.chairIndex>4?this["card"+e+"_"+this.chairIndex].addChild(new cardComponent(this.chairIndex,this["value"+e],0)):this["card"+e+"_"+this.chairIndex].addChild(new cardComponent(this.chairIndex+4,this["value"+e],0)))},e}(eui.Component);__reflect(CPGComponent.prototype,"CPGComponent",["eui.UIComponent","egret.DisplayObject"]);var settlementComponent=function(t){function e(e){var n=t.call(this)||this;return n.data=e,n.cards=n.data.cards,n}return __extends(e,t),e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.nextBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nextFun,this),console.log("显示卡222》》》》》》"),this.init()},e.prototype.init=function(){console.log("显示卡》》。"),this.showCards()},e.prototype.showCards=function(){console.log("zdfasdasd",this.cards,this.cards[1]);for(var t=1;5>t;t++){console.log(">>>",this.cards[t+""]);for(var e=0;e<this.cards[t+""].length;e++)console.log(">>>",this.cards[t+""][e]),this["hand"+t].addChild(new cardComponent(5,this.cards[t+""][e],-1))}},e.prototype.nextFun=function(){console.log(">>>>>>>>>>>隐藏"),this.visible=!1,this.parent.removeChild(this),2!=gameInfo.gameState&&(gameComponent.getInstance().reset(),socketManger.getInstance().send('{"cmd":"joinRoom","data":{"roomId":"1"}}'))},e.prototype.goBack=function(){if(console.log(">>>>>>>>>>>隐藏"),this.visible=!1,this.parent.removeChild(this),2!=gameInfo.gameState){gameComponent.getInstance().reset();var t=new egretEvent(egretEvent.REMOVE_MODEL,"game");EventManager.dispatchEvent(t);var e=new egretEvent(egretEvent.ADD_MODEL,"lobby");EventManager.dispatchEvent(e)}},e}(eui.Component);__reflect(settlementComponent.prototype,"settlementComponent",["eui.UIComponent","egret.DisplayObject"]);var LocalData=function(){function t(){}return Object.defineProperty(t,"roomId",{get:function(){return egret.localStorage.getItem(this.ROOM_ID)},set:function(t){egret.localStorage.setItem(this.ROOM_ID,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"token",{get:function(){return egret.localStorage.getItem(this.APP_TOKEN)},set:function(t){egret.localStorage.setItem(this.APP_TOKEN,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"joinRUI",{get:function(){return egret.localStorage.getItem(this.JOIN_RUI)},set:function(t){egret.localStorage.setItem(this.JOIN_RUI,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"userName",{get:function(){return egret.localStorage.getItem(this.DEBUG_USERNAME)},set:function(t){egret.localStorage.setItem(this.DEBUG_USERNAME,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"userKey",{get:function(){return egret.localStorage.getItem(this.DEBUG_USERKEY)},set:function(t){egret.localStorage.setItem(this.DEBUG_USERKEY,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isSaveName",{get:function(){return egret.localStorage.getItem(this.DEBUG_ISSAVE_USERNAME)},set:function(t){egret.localStorage.setItem(this.DEBUG_ISSAVE_USERNAME,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"serverTime",{get:function(){return t.Server_Timestamp},set:function(e){t.Server_Timestamp=e,t.Local_Timestamp=Math.floor((new Date).getTime()/1e3)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"localTime",{get:function(){return t.Local_Timestamp},enumerable:!0,configurable:!0}),t.timerDiff=function(e){return e-t.Server_Timestamp-(Math.floor((new Date).getTime()/1e3)-t.Local_Timestamp)},Object.defineProperty(t,"gameVoice",{get:function(){var t=egret.localStorage.getItem(this.GAME_VOICE);return t||(this.gameVoice="0"),egret.localStorage.getItem(this.GAME_VOICE)},set:function(t){egret.localStorage.setItem(this.GAME_VOICE,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"bgVoice",{get:function(){var t=egret.localStorage.getItem(this.BG_VOICE);return t||(this.bgVoice="0"),egret.localStorage.getItem(this.BG_VOICE)},set:function(t){egret.localStorage.setItem(this.BG_VOICE,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"bulletVoice",{get:function(){var t=egret.localStorage.getItem(this.BULLET_VOICE);return t||(this.bulletVoice="0"),egret.localStorage.getItem(this.BULLET_VOICE)},set:function(t){egret.localStorage.setItem(this.BULLET_VOICE,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"gameLanguage",{get:function(){var t=egret.localStorage.getItem(this.GAME_LANGUAGE);return t||(this.gameLanguage="0"),egret.localStorage.getItem(this.GAME_LANGUAGE)},set:function(t){egret.localStorage.setItem(this.GAME_LANGUAGE,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"gamePlayCardType",{get:function(){var t=egret.localStorage.getItem(this.GAME_PLAY_CARD_TYPE);return t||(this.gamePlayCardType="0"),egret.localStorage.getItem(this.GAME_PLAY_CARD_TYPE)},set:function(t){egret.localStorage.setItem(this.GAME_PLAY_CARD_TYPE,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"gameTableStyle",{get:function(){var t=egret.localStorage.getItem(this.GAME_TABLE_STYLE);return t||(this.gameTableStyle="0"),egret.localStorage.getItem(this.GAME_TABLE_STYLE)},set:function(t){egret.localStorage.setItem(this.GAME_TABLE_STYLE,t)},enumerable:!0,configurable:!0}),t.isDialect=!1,t.BG_VOICE="BG_VOICE",t.GAME_VOICE="GAME_VOICE",t.BULLET_VOICE="BULLET_VOICE",t.GAME_LANGUAGE="GAME_LANGUAGE",t.GAME_PLAY_CARD_TYPE="GAME_PLAY_CARD_TYPE",t.GAME_TABLE_STYLE="GAME_TABLE_STYLE",t.APP_TOKEN="APP_TOKEN",t.ROOM_ID="ROOM_ID",t.JOIN_RUI="JOIN_RUI",t.DEBUG_USERNAME="DEBUG_USERNAME",t.DEBUG_USERKEY="DEBUG_USERKEY",t.DEBUG_ISSAVE_USERNAME="DEBUG_ISSAVE_USERNAME",t}();__reflect(LocalData.prototype,"LocalData");var loadComponent=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(eui.UIEvent.COMPLETE,e.createView,e),e.skinName="resource/eui_skins/skins/loadComponent.exml",e.createView(),e}return __extends(e,t),e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.createView=function(){},e.prototype.onProgress=function(t,e){this.textField.text=t+"/"+e},e}(eui.Component);__reflect(loadComponent.prototype,"loadComponent",["RES.PromiseTaskReporter"]);var InputComponent=function(t){function e(){var e=t.call(this)||this;return e.imagesrc="",e}return __extends(e,t),e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.inputFun,this)},e.prototype.inputFun=function(){var t=this,e=document.createElement("input");e.readOnly=!0,document.body.appendChild(e),e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.setAttribute("multiple","multiple"),e.setAttribute("id","input_id"),e.style.display="none",e.onchange=function(){console.log("input输出:",e.value,e.files[0]),console.log(">>>>>>>",window.URL.createObjectURL(e.files[0])),t.imagesrc=window.URL.createObjectURL(e.files[0]);var n=window.URL.createObjectURL(e.files[0]),o=new egret.ImageLoader;o.crossOrigin="anonymous",o.load(n),o.once(egret.Event.COMPLETE,function(e){if(e.currentTarget.data){egret.log("加载头像成功: "+e.currentTarget.data);var n=new egret.Texture;n.bitmapData=e.currentTarget.data;new egret.Bitmap(n);t.inputImage.source=n}},t)},e.click(),e.onclick=function(){console.log("input输出>>>:",e.value,t,"weawe1"),t.inputImage.source=e.value}},e}(eui.Component);__reflect(InputComponent.prototype,"InputComponent",["eui.UIComponent","egret.DisplayObject"]);var lobbyComponent=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init(),this.submit.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitFun,this)},e.prototype.submitFun=function(){var t=this;this.submitGrp.visible=!0;var e=this.before_input.imagesrc,n=new egret.ImageLoader;n.crossOrigin="anonymous",n.load(e),n.once(egret.Event.COMPLETE,function(e){if(e.currentTarget.data){egret.log("加载头像成功: "+e.currentTarget.data);var n=new egret.Texture;n.bitmapData=e.currentTarget.data;new egret.Bitmap(n);t.before.source=n}},this);var o=this.after_input.imagesrc,i=new egret.ImageLoader;i.crossOrigin="anonymous",i.load(o),i.once(egret.Event.COMPLETE,function(e){if(e.currentTarget.data){egret.log("加载头像成功: "+e.currentTarget.data);var n=new egret.Texture;n.bitmapData=e.currentTarget.data;new egret.Bitmap(n);t.after.source=n}},this)},e.prototype.init=function(){},e.prototype.reChargeFun=function(){},e.prototype.closeRechargeFun=function(){window.setPage("","none")},e}(eui.Component);__reflect(lobbyComponent.prototype,"lobbyComponent",["eui.UIComponent","egret.DisplayObject"]);var RechargeComponent=function(t){function e(){var e=t.call(this)||this;return e.goldData=null,e.diamondData=null,e.touchType="gold",e}return __extends(e,t),e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.showUp(),this.btnGold.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changeList.bind(this,"gold"),this),this.btnDiamond.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changeList.bind(this,"diamond"),this)
},e.prototype.changeList=function(t){"gold"==t?(this.gold.visible=!0,this.diamond.visible=!1):"diamond"==t&&(this.gold.visible=!1,this.diamond.visible=!0)},e.prototype.initGold=function(t){this.goldData=t},e.prototype.initDiamond=function(t){this.diamondData=t},e.prototype.showUp=function(){for(var t=0;t<this.goldData.data.length;t++){console.log(this.goldData.data[t],this.goldData.data[t].diamondNum,this.goldData.data[t].goldNum);var n=new waresComponent("gold",this.goldData.data[t].diamondNum,this.goldData.data[t].goldNum,t);e.getInstance().gold.addChild(n)}for(var t=0;t<this.diamondData.data.length;t++){console.log(this.diamondData.data[t],this.diamondData.data[t].CNY,this.diamondData.data[t].gameCurrency);var o=new waresComponent("diamond",this.diamondData.data[t].CNY,this.diamondData.data[t].gameCurrency,t);e.getInstance().diamond.addChild(o)}},e}(eui.Component);__reflect(RechargeComponent.prototype,"RechargeComponent",["eui.UIComponent","egret.DisplayObject"]);var roomComponent=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.data=gameInfo.roomList.data,this.updata(),this.init()},e.prototype.updata=function(){HttpPostManger.getInstance().send("?c=uc&a=getGameRule","gameId=1",this.setGameRule)},e.prototype.setGameRule=function(t){console.log("游戏规则",t),e.getInstance().ruleTxt.text=t.data.data},e.prototype.init=function(){for(var t=this,e=0;e<this.data.length;e++)this["room_"+(e+1)].addEventListener(egret.TouchEvent.TOUCH_TAP,this.joinRoom.bind(this,e+1),this),this["need_"+(e+1)].text="入场所需金币:"+this.data[e].needGold,this["basePoint_"+(e+1)].text="(场次倍数:"+this.data[e].basePoint+")",this["roomName_"+(e+1)].text=this.data[e].roomName,this["room_"+(e+1)].name=this.data[e].id;this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.parent.removeChild(t)},this),this.ruleBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.ruleGrp.visible=!0},this),this.ruleGrp.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.ruleGrp.visible=!1},this)},e.prototype.joinRoom=function(t){console.log("所选场次",t),socketManger.getInstance().send('{"cmd":"leaveRoom","data":{}}'),socketManger.getInstance().send('{"cmd":"quitGame","data":{}}'),socketManger.getInstance().send('{"cmd":"joinRoom","data":{"roomId":"1"}}')},e}(eui.Component);__reflect(roomComponent.prototype,"roomComponent",["eui.UIComponent","egret.DisplayObject"]);var userComponent=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeFun,this),this.upData()},e.prototype.upData=function(){this.head.source=userInfo.headImg,null==userInfo.headImg&&(this.head.source="face1_png"),this.nickName.text=userInfo.nickName,this.loseNum.text=userInfo.loseNum,this.winNum.text=userInfo.winNum},e.prototype.closeFun=function(){this.parent.removeChild(this)},e}(eui.Component);__reflect(userComponent.prototype,"userComponent",["eui.UIComponent","egret.DisplayObject"]);var waresComponent=function(t){function e(e,n,o,i){var a=t.call(this)||this;return a.type="",a.value0=null,a.value1=null,a.index=-1,a.type=e,a.value0=n,a.value1=o,a.index=i,a}return __extends(e,t),e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init(),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.buyFun,this)},e.prototype.init=function(){console.log(this.type,this.value1,this.value0,this.index),"gold"==this.type?(this.img.source="200"+(this.index+1)+"_png",this.txt.text="获得"+this.value1+"金币",this.price.text="需"+this.value0+"钻石"):"diamond"==this.type&&(this.img.source="icon_play_arrow_png",this.txt.text="获得"+this.value1.diamondNum+"钻石及赠"+this.value1.giveDiamondNum+"钻石",this.price.text="需"+this.value0+"RMB"),console.log(this.img.source)},e.prototype.buyFun=function(){if("gold"==this.type){if(this.value0>userInfo.diamond)return void console.log("钻石不足");HttpPostManger.getInstance().send("?c=uc&a=exchangeGold","&diamondNum="+this.value0,this.setBuyGold)}else"diamond"==this.type},e.prototype.setBuyGold=function(t){console.log("兑换钻石",t)},e}(eui.Component);__reflect(waresComponent.prototype,"waresComponent",["eui.UIComponent","egret.DisplayObject"]);var loginComponent=function(t){function e(){var e=t.call(this)||this;return e.timestamp=0,e.token="",e.callPhone="",e.vCodeNum="",e.vCodeTimer=new egret.Timer(1e3,60),e.timeSecond=60,e}return __extends(e,t),e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.getVCode=function(){console.log("点击"),this.vCodeBtn.touchEnabled=!1,this.callPhone=this.userId.text,this.vCodeTimer.start(),HttpPostManger.getInstance().send("?c=u&a=getSmsCode","cellphone="+this.callPhone+"&key=login",this.setVcode)},e.prototype.setVcode=function(t){console.log("getVcode",t),0==t.code?(e.getInstance().token=t.data.token,e.getInstance().timestamp=t.data.timestamp):alert(t.message)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.yesBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.getLogin,this),this.vCodeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.getVCode,this),this.vCodeTimer.addEventListener(egret.TimerEvent.TIMER,this.showTimer,this)},e.prototype.getLogin=function(){e.getInstance().openLobby()},e.prototype.setLogin=function(t){0==t.code?(userInfo.userId=t.data.userId,userInfo.token=t.data.token,userInfo.timestamp=t.data.timestamp,e.getInstance().getUserInfo()):alert(t.message),console.log("获取登录",t,userInfo.userId)},e.prototype.getUserInfo=function(){HttpPostManger.getInstance().send("?c=uc&a=getUserInfo","",this.setUserInfo)},e.prototype.setUserInfo=function(t){userInfo.headImg=t.data.avatar?t.data.avatar:"face1_png",userInfo.createTime=t.data.createTime,userInfo.diamond=parseInt(t.data.diamondNum),userInfo.gameId=t.data.gId,userInfo.gold=parseInt(t.data.goldNum),userInfo.ip=t.data.ip,userInfo.isDisabled=t.data.isDisabled,userInfo.loseNum=t.data.loseNum,userInfo.nickName=t.data.nickname,userInfo.point=t.data.point,userInfo.sex=t.data.sex,userInfo.userId=parseInt(t.data.userId),userInfo.winNum=t.data.winNum},e.prototype.showTimer=function(t){this.timeSecond--,this.vCodeBtn.label="获取验证码("+this.timeSecond+")",0==this.timeSecond&&(this.vCodeTimer.stop(),this.vCodeTimer.reset(),this.timeSecond=60,this.vCodeBtn.touchEnabled=!0,this.vCodeBtn.label="获取验证码")},e.prototype.openLobby=function(){console.log(">>>>>>>>>>>>>>");var t=new egretEvent(egretEvent.ADD_MODEL,"lobby");EventManager.dispatchEvent(t);var e=new egretEvent(egretEvent.REMOVE_MODEL,"login");EventManager.dispatchEvent(e)},e.prototype.wxLogin=function(){},e}(eui.Component);__reflect(loginComponent.prototype,"loginComponent",["eui.UIComponent","egret.DisplayObject"]);var DynamicChange=function(){function t(){this._dataCache=[],this._pUpdate=new ProxyUpdate(this._dataCache)}return Object.defineProperty(t.prototype,"pUpdate",{get:function(){return this._pUpdate},enumerable:!0,configurable:!0}),t.prototype.getCacheData=function(t){return this._dataCache[t]?this._dataCache[t]:null},t.prototype.clearCache=function(){for(var t=Object.keys(this._dataCache),e=0,n=t.length;n>e;e++){var o=t[e];this._dataCache[o]=null,delete this._dataCache[o]}},t.prototype.getCacheKeyInfos=function(){for(var t=[],e=Object.keys(this._dataCache),n=0,o=e.length;o>n;n++){var i=e[n],a=this._dataCache[i];t.push(a)}return t},t.prototype.isCache=function(t){return this._dataCache[t]},t}();__reflect(DynamicChange.prototype,"DynamicChange");var ProxyUpdate=function(){function t(t){this._cache=t}return t.prototype.isArray=function(t){return t instanceof Array},t.prototype.isObject=function(t){return t.indexOf("object")>-1},t.prototype.isNormal=function(t){var e=t.indexOf("@")>-1,n=t.indexOf(".")>-1,o=t.indexOf("_")>-1;return!e&&!n&&!o},t.prototype.isAddToArray=function(t){return"@a"==t},t.prototype.isRemoveToArray=function(t){var e=t.split("_");return e.length<=3&&"@d"==e[0]},t.prototype.isFilter=function(t){var e=t.split("_");return"@f"==e[0]},t.prototype.isNumeric=function(t){return parseFloat(t).toString()==t.toString()},t.prototype._updateObject=function(t,e,n){var o=t.split(".");"@a"==o[0]||"@s"==o[0]?n[o[1]]=e:"@d"==o[0]&&delete n[o[1]]},t.prototype._getFilterObject=function(t,e){if(e){var n=t.split("_");if(3==n.length&&"@f"==n[0]&&this.isArray(e))for(var o=n[1],i=n[2],a=0;a<e.length;a++){var r=e[a];if(3==n.length&&this.isObject(r.toString())){var s=r[o];if(s&&("@"==i[0]&&(i=i.replace("@","")),i==s))return r}}}return null},t.prototype._addObjectToArray=function(t,e){if(this.isArray(e))for(var n=0;n<e.length;n++)t.push(e[n]);else t.push(e)},t.prototype._removeObjectFromArray=function(t,e,n){var o=e.split("_");if(o.length<=3&&"@d"==o[0]&&this.isArray(t))for(var i=t.length,a=i-1;a>=0;a--){var r=t[a];if(3==o.length){if(r.hasOwnProperty(o[1])){var s=o[2];"@"==s[0]&&(s=s.replace("@","")),s==r[o[1]]&&t.splice(a,1)}}else 2==o.length&&r.hasOwnProperty(o[1])?n==r[o[1]]&&t.splice(a,1):1==o.length&&n==r&&t.splice(a,1)}},t.prototype.update=function(t,e){if(this._cache[t]=e,e.hasOwnProperty("c"))for(var n=e.c,o=Object.keys(n),i=0,a=o.length;a>i;i++){var r=o[i];this._cache[r]&&(this._update(this._cache[r],n[r]),console.log("刷新数据"))}},t.prototype._update=function(t,e){if(t&&e&&this.isObject(e.toString()))for(var n=Object.keys(e),o=0,i=n.length;i>o;o++){var a=n[o],r=e[a];if(this.isNormal(a)&&this.isObject(r.toString()))t.hasOwnProperty(a)&&this._update(t[a],r);else if(this.isNormal(a)&&this.isNumeric(r)){var s=t[a];t[a]=s+r}else if(this.isNormal(a))t[a]=r;else if(this.isAddToArray(a))this._addObjectToArray(t,r);else if(this.isRemoveToArray(a))this._removeObjectFromArray(t,a,r);else if(this.isFilter(a)){var c=this._getFilterObject(a,t);c&&this._update(c,r)}else this._updateObject(a,r,t)}},t}();__reflect(ProxyUpdate.prototype,"ProxyUpdate");var Http=function(t){function e(){var e=t.call(this)||this;return e._data=new DynamicChange,e._cache=[],e._request=new egret.URLRequest,e._request.method=egret.URLRequestMethod.POST,e._urlLoader=new egret.URLLoader,e._urlLoader.addEventListener(egret.IOErrorEvent.IO_ERROR,e.onError,e),e}return __extends(e,t),e.prototype.initServer=function(t){this._serverUrl=t},Object.defineProperty(e.prototype,"Data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e.prototype.onError=function(t){this.nextPost()},e.prototype.send=function(t,e){this._cache.push([t,e]),this.post()},e.prototype.post=function(){if(!this._isRequesting&&0!=this._cache.length){var t=this._cache.shift(),e=t[0],n=t[1];this._type=e,this._request.url=this._serverUrl,this._request.data=n,this._urlLoader.addEventListener(egret.Event.COMPLETE,this.onLoaderComplete,this),this._urlLoader.load(this._request),this._isRequesting=!0}},e.prototype.onLoaderComplete=function(t){this._urlLoader.removeEventListener(egret.Event.COMPLETE,this.onLoaderComplete,this);var e=JSON.parse(this._urlLoader.data);e.hasOwnProperty("s")&&0!=e.s?console.log("Http错误:"+e.s):(this._data.pUpdate.update(this._type,e),console.log("http返回的数据")),this.nextPost()},e.prototype.nextPost=function(){this._isRequesting=!1,this.post()},e}(BaseClass);__reflect(Http.prototype,"Http");var HttpPostManger=function(t){function e(){var e=t.call(this)||this;return e.request=new XMLHttpRequest,e}return __extends(e,t),e.prototype.send=function(t,e,n){return __awaiter(this,void 0,void 0,function(){var o=this;return __generator(this,function(i){return this.request.open("POST",gameInfo.httpIp+t),this.request.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),0!=userInfo.userId?this.request.send(e+"&userId="+userInfo.userId+"&timestamp="+userInfo.timestamp+"&token="+userInfo.token):this.request.send(e),this.request.onreadystatechange=function(){if(4==o.request.readyState)if(200==o.request.status){var t=o.request.responseText,e=JSON.parse(t.toString());n(e)}else console.log("error",o.request.status)},[2]})})},e}(BaseClass);__reflect(HttpPostManger.prototype,"HttpPostManger");var socketManger=function(t){function e(){var e=t.call(this)||this;return e._socket=new egret.WebSocket,e._socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,e.onReceiveMessage,e),e._socket.addEventListener(egret.Event.CONNECT,e.onSocketOpen,e),e._socket.addEventListener(egret.Event.CLOSE,e.onSocketClose,e),e._socket.addEventListener(egret.IOErrorEvent.IO_ERROR,e.onSocketError,e),e._socket.type=egret.WebSocket.TYPE_STRING,e._heart=new egret.Timer(3e4,0),e._heart.addEventListener(egret.TimerEvent.TIMER,e.heart,e),e}return __extends(e,t),e.prototype.heart=function(){console.log("心跳"),this._socket.writeUTF('{"cmd":"heartBeat","data":{}}')},e.prototype.connect=function(){this._socket.connect(gameInfo.websocketIp,gameInfo.websocketHost)},e.prototype.onReceiveMessage=function(t){console.log("接收消息",t);var e=JSON.parse(this._socket.readUTF());switch(console.log("收到消息",e),e.cmd){case"loginSuccess":console.log("登录成功",e.data),this._heart.start();break;case"joinRoomSuccess":break;case"waitStart":gameInfo.gameState=1;var n=new egretEvent(egretEvent.ADD_MODEL,"game");EventManager.dispatchEvent(n);var o=new egretEvent(egretEvent.REMOVE_MODEL,"lobby");EventManager.dispatchEvent(o);break;case"startGame":console.log("开始游戏",e.data),gameInfo.gameState=2,gameComponent.getInstance().startGame(e),gameComponent.getInstance().setHandData(e.data.cards),gameComponent.getInstance().setdiceNum(e.data.diceNum),gameComponent.getInstance().location=e.data.location;break;case"getCard":0!=e.data.value?gameComponent.getInstance().getCard(e.data.value,e.data.location):gameComponent.getInstance().getCard(-1,e.data.location);break;case"showCard":console.log("显示牌",e.data.value,e.data.location),gameComponent.getInstance().setCard(e.data.value,e.data.location);break;case"hasChowPongKongWin":console.log("显示吃碰杠胡",e.data),gameComponent.getInstance().showCPGBtn(e.data);break;case"showChowPongKong":console.log("谁吃碰杠胡了",e.data),gameComponent.getInstance().showCPG(e.data);break;case"hasKongWin":for(var i=0;i<e.data.length;i++)"pKong"==e.data[i].type?gameComponent.getInstance().cpKongFun(e.data):"cKong"==e.data[i].type?gameComponent.getInstance().cpKongFun(e.data):"cWin"==e.data[i].type&&gameComponent.getInstance().cWinFun(e.data);console.log("摸牌阶段杠胡",e.data);break;case"showKong":gameComponent.getInstance().showCPG(e),console.log("摸牌阶段暗杠或补杠",e.data);break;case"gameover":gameInfo.gameState=0,console.log("胡了",e.data),gameComponent.getInstance().showSettlement(e.data)}},e.prototype.onSocketOpen=function(t){console.log("连接成功",t)},e.prototype.onSocketClose=function(t){console.log("连接关闭",t)},e.prototype.onSocketError=function(t){console.log("连接报错",t)},e.prototype.send=function(t){this._socket.writeUTF(t)},e}(BaseClass);__reflect(socketManger.prototype,"socketManger");var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.createGameScene(),[4,this.loadResource()];case 1:return t.sent(),this.setResize(),[2]}})})},e.prototype.setResize=function(){this.stage.orientation==egret.OrientationMode.LANDSCAPE?this.stage.stageHeight>this.stage.stageWidth?(console.log("height"),this.stage.orientation=egret.OrientationMode.LANDSCAPE):(console.log("width"),this.stage.orientation=egret.OrientationMode.AUTO):this.stage.stageHeight>this.stage.stageWidth?(console.log("height"),this.stage.orientation=egret.OrientationMode.AUTO):(console.log("width"),this.stage.orientation=egret.OrientationMode.LANDSCAPE),this.stage.scaleMode=egret.StageScaleMode.SHOW_ALL},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return e.sent(),this.loadingView=new loadComponent,this.stage.addChild(this.loadingView),[4,this.loadTheme()];case 2:return e.sent(),EventManager.dispatchEvent(new egretEvent(egretEvent.ADD_MODEL,"login")),this.stage.removeChild(this.loadingView),[3,4];case 3:return t=e.sent(),console.error(t),[3,4];case 4:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,n){var o=new eui.Theme("resource/default.thm.json",t.stage);o.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){this.initModule()},e.prototype.initModule=function(){this.ctrl=new ctrl,this.addChild(this.ctrl),this.openSocket()},e.prototype.openSocket=function(){socketManger.getInstance(),socketManger.getInstance().connect()},e.prototype.onReceiveMessage=function(t){console.log(this.socket,this.socket.readUTF())},e.prototype.login=function(){},e}(BaseClass);__reflect(Main.prototype,"Main");var SoundBg=function(t){function e(){var e=t.call(this)||this;return e._currBg="",e}return __extends(e,t),e.prototype.stop=function(){this._currSoundChannel&&this._currSoundChannel.stop(),this._currSoundChannel=null,this._currSound=null,this._currBg=""},e.prototype.play=function(t){if(this._currBg!=t){this.stop(),this._currBg=t;var e=this.getSound(t);e&&this.playSound(e)}},e.prototype.bgplay=function(t){if(this._currBg!=t){this.stop(),this._currBg=t;var e=this.getSound(t);e&&this.playBgSound(e)}},e.prototype.playSound=function(t){this._currSound=t,this._currSoundChannel=this._currSound.play(0,1),this._currSoundChannel.volume=this._volume},e.prototype.playBgSound=function(t){this._currSound=t,this._currSoundChannel=this._currSound.play(0,-1),this._currSoundChannel.volume=this._volume},e.prototype.setVolume=function(t){this._volume=t,this._currSoundChannel&&(this._currSoundChannel.volume=this._volume)},e.prototype.loadedPlay=function(t){console.log("资源加载完成后处理播放",this._currBg,t),this._currBg==t&&this.playSound(RES.getRes(t))},e.prototype.checkCanClear=function(t){return this._currBg!=t},e}(BaseSound);__reflect(SoundBg.prototype,"SoundBg");var SoundEffects=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.play=function(t){var e=this.getSound(t);e&&this.playSound(e)},e.prototype.stop=function(){this.stop()},e.prototype.play2=function(t){var e=this.getSound(t);console.log("播放音效",e);var n=this.soundChannel;n&&(console.log("先停止",n),n.stop(),this.soundChannel=null),e&&this.palySound2(e)},e.prototype.palySound2=function(t){try{this.soundChannel=t.play(0,1),this.soundChannel.volume=this._volume}catch(e){}},e.prototype.playSound=function(t){try{var e=t.play(0,1);e.volume=this._volume}catch(n){}},e.prototype.setVolume=function(t){this._volume=t},e.prototype.loadedPlay=function(t){this.playSound(RES.getRes(t))},e}(BaseSound);__reflect(SoundEffects.prototype,"SoundEffects");var SoundManager=function(t){function e(){var e=t.call(this)||this;return e.bgOn=!0,e.effectOn=!0,e.bgVolume=.5,e.effectVolume=.5,e.bg=new SoundBg,e.bg.setVolume(e.bgVolume),e.effect=new SoundEffects,e.effect.setVolume(e.effectVolume),e}return __extends(e,t),e.prototype.playEffect=function(t){this.effectOn&&"1"!=LocalData.gameVoice&&this.effect.play(t)},e.prototype.playEffect2=function(t){this.effectOn&&"1"!=LocalData.gameVoice&&this.effect.play2(t)},e.prototype.playBg=function(t){this.currBg=t,this.bgOn&&"1"!=LocalData.gameVoice&&this.bg.bgplay(t)},e.prototype.stopBg=function(){this.bg.stop()},e.prototype.setEffectOn=function(t){this.effectOn=t},e.prototype.setBgOn=function(t){this.bgOn=t,this.bgOn?this.currBg&&this.playBg(this.currBg):this.stopBg()},e.prototype.setBgVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.bgVolume=t,this.bg.setVolume(this.bgVolume)},e.prototype.getBgVolume=function(){return this.bgVolume},e.prototype.setEffectVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.effectVolume=t,this.effect.setVolume(this.effectVolume)},e.prototype.getEffectVolume=function(){return this.effectVolume},e.CLEAR_TIME=18e4,e}(BaseClass);__reflect(SoundManager.prototype,"SoundManager");